import * as BABYLON from '@babylonjs/core';
import { zoomAll } from './zoomAll'

export async function preloadMesh(predefinedMeshFile, scene) {
    try {
        console.log("Loading mesh from:", predefinedMeshFile);
        
        // Load the mesh using SceneLoader
        const result = await BABYLON.SceneLoader.LoadAssetContainerAsync(
            "", 
            predefinedMeshFile, 
            scene, 
            undefined, 
            ".stl"
        );

        // Add all meshes to the scene
        result.addAllToScene();

        // show mesh edges as wireframe
        const mesh = result.meshes[0];
        mesh.enableEdgesRendering(1);
        mesh.edgesWidth = 4.0;
        mesh.edgesColor = new BABYLON.Color4(0, 0, 0, 1);
        mesh.wireframe = true;
        
        console.log("Mesh loaded successfully");
        zoomAll(scene);

    } catch (error) {
        console.error("Error loading STL:", error);
        throw error;
    }
}

export function loadPoints(store) {
    const pointsString = `[
        {"X": 56.62470991384823, "Y": 7.571749611467557, "Z": 355.2433762577112},
        {"X": 58.12723522267518, "Y": 5.659826363387001, "Z": 355.85166905536937},
        {"X": 59.045628404626015, "Y": 3.6987436876841646, "Z": 356.339917223226},
        {"X": 60.57835177194103, "Y": 1.9817195561505458, "Z": 356.63131527710834},
        {"X": 60.872622348688616, "Y": 0.23381299870493472, "Z": 357.0603578023751},
        {"X": 59.093885509999986, "Y": -0.2909518938511468, "Z": 356.5945913380154},
        {"X": 57.00281394872377, "Y": -0.2909518938511752, "Z": 356.0088414628425},
        {"X": 54.60622532880892, "Y": -0.2909518938511468, "Z": 355.4825133371716},
        {"X": 52.28390922192198, "Y": -0.290951893851161, "Z": 354.36030322486397},
        {"X": 50.10292038485518, "Y": -0.2909518938511468, "Z": 353.53775126809796},
        {"X": 48.14291624775396, "Y": -0.2909518938511752, "Z": 353.28600376250887},
        {"X": 47.67987510556759, "Y": 1.9560605648472411, "Z": 353.073905352652},
        {"X": 48.150773501299376, "Y": 3.77298542728068, "Z": 353.53701037477185},
        {"X": 49.119682420339174, "Y": 5.618491581465707, "Z": 353.5639931423705},
        {"X": 50.15465109054689, "Y": 7.147778160301961, "Z": 353.014644446556},
        {"X": 54.05295688295659, "Y": 7.4229595927189225, "Z": 354.69509095107384},
        {"X": 54.64391849591533, "Y": 8.063860100555585, "Z": 354.66169472326976}
    ]`;

    const pointsString1 = `[
        {"X": 6.9240288014921285, "Y": 22.2899634583098, "Z": 16.94284926695191},
        {"X": 2.5531234658139583, "Y": 22.986067312973546, "Z": 20.726095703795945},
        {"X": -4.17742855247429, "Y": 21.340407078339577, "Z": 21.234234749009754},
        {"X": -8.386194795842579, "Y": 19.769382676401076, "Z": 18.479987296053835},
        {"X": -10.808284909549986, "Y": 19.516694635130314, "Z": 13.16943851238793},
        {"X": -9.972794904897277, "Y": 20.782251894078968, "Z": 6.667509584328567},
        {"X": -6.511614614772604, "Y": 19.76574652550906, "Z": 1.735161186503958},
        {"X": 1.3618936051164674, "Y": 19.028959138270686, "Z": 0.024024803535422024},
        {"X": 7.025966811196662, "Y": 19.92644854227698, "Z": 4.500460175235786},
        {"X": 7.8248336141385995, "Y": 26.55067239747207, "Z": 10.681444565869729},
        {"X": 7.476296739428905, "Y": 24.058909472561453, "Z": 15.074431699915136}]`

    const pointsArray = JSON.parse(pointsString1);
    store.points = pointsArray.map(point => new BABYLON.Vector3(point.X, point.Y, point.Z));
}

